<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
			PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
			"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="movie">

	<resultMap class="movieVo" id="MovieMainMap">
		<result property="movie_code" column="movie_code"/>
		<result property="name" column="name"/>
		<result property="audi_rating" column="audi_rating"/>
	</resultMap>

	<select id="findAll" parameterClass="movieSearch" resultClass="movieVo">
		SELECT MOVIE_CODE, NAME, AUDI_RATING, RUNTIME
		FROM   MOVIE
		<dynamic prepend="WHERE">
		    <isNotNull property="content">
				<isEqual prepend="AND"  property="movieSearchCategory" compareValue="NAME">
					NAME LIKE '%' || #content# || '%'
				</isEqual>
				<isEqual prepend="AND"  property="movieSearchCategory" compareValue="AUDI_RATING">
					AUDI_RATING LIKE '%' || #content# || '%'
				</isEqual>
			</isNotNull>
		</dynamic>
		ORDER BY LENGTH(MOVIE_CODE), MOVIE_CODE
	</select>
</sqlMap>			





